Phase 2 approved.

Proceed with Phase 3 only: verify shared Zod schemas cover all P0 forms and API payloads, and add server-side validation middleware using shared/ schemas.

Requirements
- Do not begin Phase 4 (Vitest/Supertest) or Phase 5 (Playwright) yet.
- shared/ must be the source of truth for request validation.
- Every P0 API route must have:
  1) a Zod schema for request body (and params/query where applicable)
  2) validation middleware applied
  3) consistent error response shape on validation failures

Scope and Tasks

1) Inventory P0 endpoints from QUALITY_REPORT.md and list which already have shared schemas and which do not.

2) In shared/, create or extend Zod schemas for:
   - Auth payloads (login, signup if exists, password reset if exists)
   - Consignment form payload
   - Inventory create/update payloads
   - Lead form payloads
   - Any other P0 submissions identified in Phase 1

3) Implement reusable Express middleware:
   - validateBody(schema)
   - validateParams(schema) if needed
   - validateQuery(schema) if needed

4) Apply validation to each P0 route and ensure failures return:
   - HTTP 400
   - {
       error: {
         code: "VALIDATION_ERROR",
         message: string,
         details: [...]
       }
     }

5) Ensure client and server types are aligned:
   - Client form validation should reuse shared schemas where practical
   - At minimum, client must reuse inferred TypeScript types from shared schemas

6) Update QUALITY_REPORT.md with a new section:
   "Schema Coverage"
   showing:
   - Endpoint
   - Schema file
   - Middleware applied (yes/no)

Audit behavior

Default to Option B:

Option B (report-only):
- Keep npm audit from failing the quality gate
- Create AUDIT_NOTES.md listing:
  - vulnerability
  - severity
  - package
  - recommended upgrade

Deliverables

- List all shared schema files added/changed
- List all server routes updated with validation
- Show an example validation error response
- Confirm `npm run typecheck` still passes
- Confirm no P0 endpoint accepts unvalidated input

Stop after Phase 3 is complete and report results.

Optional improvement (mandatory to implement):

Add a helper to normalize Zod errors into a stable format:

[
  { path: "field.subfield", message: "..." }
]

Use this formatter in all validation middleware so error output is consistent across all endpoints.
